var TooltipComments=new Class.create();TooltipComments.prototype={_requestData:{entityId:null,entity:null,type:null,pagination:{pageNo:1,pageSize:30}},_target:{element:null,event:null},_pageObj:null,initialize:function(a){this._pageObj=a},_getCommentRows:function(a){var b={};b.me=this;b.newDiv=jQuery('<div class="tipcommentslist"></div>');jQuery.each(a,function(c,d){jQuery('<fieldset class="row"></fieldset>').append(jQuery('<legend class="inlineblock type"></legend>').html(d.type)).append(jQuery('<span class="inlineblock who"></span>').html(d.createdBy.person.fullname)).append(jQuery('<span class="inlineblock when"></span>').html(d.created)).append(jQuery('<span class="inlineblock what"></span>').html(d.comments)).appendTo(b.newDiv)});return b.newDiv},_getCommentsData:function(c,b){var a={};a.me=this;jQuery.ajax({url:"/ajax/getComments",data:a.me._requestData,type:"POST",dataType:"json"}).then(function(d){a.result="Nothing found";if(d.items&&d.items instanceof Array&&d.items.length>0){a.result=a.me._getCommentRows(d.items)}b.set("content.text",a.result)},function(f,d,e){b.set("content.text",d+": "+e)});return"Loading..."},_getComments:function(b,c){var a={};a.me=this;a.me._target.element=b;a.me._target.event=c;a.me._requestData.entity=$(b).readAttribute("tooltipcomments_entity");a.me._requestData.entityId=$(b).readAttribute("tooltipcomments_entityid");a.me._requestData.type=$(b).readAttribute("tooltipcomments_commentstype");jQuery(b).qtip({position:{my:"right center",at:"left center",target:jQuery(b),viewport:jQuery(window)},overwrite:false,show:{event:c.type,ready:true},hide:{fixed:true,delay:300},style:{classes:"qtip-bootstrap qtip-shadow"},content:{text:function(e,d){return a.me._getCommentsData(e,d)},title:function(e,d){return"Comments:"}}})}};