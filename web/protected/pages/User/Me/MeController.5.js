var PageJs=new Class.create();PageJs.prototype=Object.extend(new BPCPageJs(),{_getFormFields:function(b,a){return $(b).up(".contentDiv").getElementsBySelector("["+a+"]")},_collectingFields:function(c,b){var a={};a.me=this;a.data={};a.foundData=false;a.me._getFormFields(c,b).each(function(d){if(d.hasAttribute("required")&&$F(d).blank()){d.up(".form-group").addClassName("has-error")}else{d.up(".form-group").removeClassName("has-error");a.foundData=true}a.data[d.readAttribute(b)]=$F(d)});if(a.foundData===true){return a.data}return null},_cleanForm:function(c,b){var a={};a.me=this;a.me._getFormFields(c,b).each(function(d){d.setValue("")});return this},changePwd:function(b){var a={};a.me=this;a.data=a.me._collectingFields(b,"change_pass");if(a.data===null){return}jQuery("#"+b.id).button("loading");a.me.postAjax(a.me.getCallbackId("changePwd"),a.data,{onLoading:function(){},onComplete:function(c,f){try{a.result=a.me.getResp(f,false,true);if(a.result.succ){a.me._cleanForm(b,"change_pass");$(b).insert({before:a.me.getAlertBox("","Password changed!").addClassName("alert-success")})}}catch(d){$(b).insert({before:a.me.getAlertBox("Error:",d).addClassName("alert-danger")})}jQuery("#"+b.id).button("reset")}})},changePInfo:function(b){var a={};a.me=this;a.data=a.me._collectingFields(b,"change_pinfo");if(a.data===null){return}jQuery("#"+b.id).button("loading");a.me.postAjax(a.me.getCallbackId("changePersonInfo"),a.data,{onLoading:function(){},onComplete:function(c,f){try{a.result=a.me.getResp(f,false,true);if(a.result.succ){$(b).insert({before:a.me.getAlertBox("","Information changed!").addClassName("alert-success")});location.reload()}}catch(d){$(b).insert({before:a.me.getAlertBox("Error:",d).addClassName("alert-danger")})}jQuery("#"+b.id).button("reset")}})}});