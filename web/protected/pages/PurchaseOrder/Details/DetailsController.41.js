var PageJs=new Class.create;PageJs.prototype=Object.extend(new DetailsPageJs,{_supplier:null,_purchaseorder:{},_newDiv:null,setPreData:function(a){var b={};return b.me=this,b.me._purchaseorder=a,b.me._supplier=a.supplier,b.me},setStatusOptions:function(a){var b={};return b.me=this,b.me._statusOptions=a,b.me},setComment:function(a){var b={};return b.me=this,b.me._comments=a,b.me},setPurchaseOrderItems:function(a){var b={};return b.me=this,b.me._purchaseOrderItems=a,b.me},_getCommentsRow:function(a,b){return new Element("tr",{class:b?"comments_row header":"comments_row"}).store("data",a).insert({bottom:new Element("td",{class:"created",width:"15%"}).update(new Element("small").update(b?"Created":a.created))}).insert({bottom:new Element("td",{class:"creator",width:"15%"}).update(new Element("small").update(b?"Who":a.createdBy.person.fullname))}).insert({bottom:new Element("td",{class:"type",width:"10%"}).update(new Element("small").update(b?"Type":a.type))}).insert({bottom:new Element("td",{class:"comments",width:"auto"}).update(b?"":a.comments.replace(/\n/g,"<br />"))})},_openOrderPrintPage:function(){var a={};return a.me=this,a.newWindow=window.open("/print/purchase/"+a.me._purchaseorder.id+".html?pdf=1",a.me._purchaseorder.status+" PO "+a.me._purchaseorder.purchaseOrderNo,"width=1300, location=no, scrollbars=yes, menubar=no, status=no, titlebar=no, fullscreen=no, toolbar=no"),a.newWindow.onload=function(){a.newWindow.document.title=a.me._purchaseorder.status+" Order "+a.me._purchaseorder.purchaseOrderNo,a.newWindow.focus(),a.newWindow.print(),a.newWindow.close()},a.me},_getItemDiv:function(){var a={};return a.me=this,a.me._newDiv=new Element("div").insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-sm-6"}).update(a.me._getSupplierInfoPanel())}).insert({bottom:new Element("div",{class:"col-sm-6"}).update(a.me._getPaymentPanel())})}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-sm-12"}).update(a.me._getInvoiceNoPanel())})}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-sm-12"}).update(a.me._getPartsTable())})}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-sm-12"}).update(a.me._getCommentsPanel())})}),a.me._purchaseOrderItems.each(function(b){a.me._addNewProductRow(a.me._newDiv.down(".glyphicon.glyphicon-floppy-saved"),b)}),a.me._newDiv.getElementsBySelector(".order-item-row").each(function(a){a.addClassName("order-item-row-old")}),a.me._newDiv},_getInvoiceNoPanel:function(){var a={};return a.me=this,a.newDiv=new Element("div",{class:"well well-sm"}).insert({bottom:a.list=new Element("ul",{class:"list-inline"}).insert({bottom:new Element("li").update(new Element("strong").update("Invoice Number(s): "))})}),a.me._purchaseorder.supplierInvoices.each(function(b){a.list.insert({bottom:new Element("li").update(new Element("a",{href:"/bills/"+a.me._purchaseorder.supplier.id+".html?invoiceNo="+b,target:"_BLANK"}).update(b))})}),a.newDiv},_getSupplierInfoPanel:function(){var a={};return a.me=this,a.supplier=a.me._purchaseorder.supplier,a.purchaseOrder=a.me._purchaseorder,a.newDiv=new Element("div",{class:"panel panel-info"}).insert({bottom:new Element("div",{class:"panel-heading"}).insert({bottom:new Element("strong").update("Editing PO "+a.purchaseOrder.purchaseOrderNo+" for "+a.supplier.name+" ")}).insert({bottom:new Element("div",{class:"pull-right"}).insert({bottom:new Element("strong",{style:"padding-left: 10px"}).update("ETA: ")}).insert({bottom:new Element("input",{style:"max-height:19px",class:"datepicker","save-order":"ETA",value:a.purchaseOrder.eta?a.purchaseOrder.eta:""})})}).insert({bottom:new Element("div",{class:"pull-right"}).insert({bottom:new Element("strong").update("Status: ")}).insert({bottom:a.me._getOrderStatus()})})}).insert({bottom:new Element("div",{class:"panel-body"}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-sm-3"}).update(a.me._getFormGroup("Contact Name",new Element("input",{"save-order":"contactName",type:"text",value:a.supplier.contactName?a.supplier.contactName:""})))}).insert({bottom:new Element("div",{class:"col-sm-3"}).update(a.me._getFormGroup("Contact Number",new Element("input",{"save-order":"contactNo",type:"value",value:a.supplier.contactNo?a.supplier.contactNo:""})))}).insert({bottom:new Element("div",{class:"col-sm-3"}).update(a.me._getFormGroup("Contact Email",new Element("input",{"save-order":"contactEmail",type:"email",value:a.supplier.email?a.supplier.email:""})))}).insert({bottom:new Element("div",{class:"col-sm-3"}).update(a.me._getFormGroup("PO Ref Num",new Element("input",{required:"required","save-order":"supplierRefNum",type:"text",value:a.purchaseOrder.supplierRefNo?a.purchaseOrder.supplierRefNo:""})))})})}),a.newDiv},_loadDataPicker:function(){return $$(".datepicker").each(function(a){new Prado.WebUI.TDatePicker({ID:a,InputMode:"TextBox",Format:"yyyy-MM-dd",FirstDayOfWeek:1,CalendarStyle:"default",FromYear:2009,UpToYear:2024,PositionMode:"Bottom",ClassName:"datepicker-layer-fixer"})}),this},_getCommentsPanel:function(){var a={};return a.me=this,a.comments=a.me._comments,a.newDiv=new Element("div",{class:"panel panel-info"}).insert({bottom:new Element("div",{class:"panel-heading"}).update("Comment History")}).insert({bottom:new Element("div",{class:"table-responsive"}).insert({bottom:new Element("table",{id:"comments_result_div",class:"table table-hover table-condensed"}).insert({bottom:new Element("thead")}).insert({bottom:new Element("tbody")})})}),a.row=a.me._getCommentsRow("",!0),a.newDiv.down("#comments_result_div thead").insert({bottom:a.row}),a.comments.each(function(b){""!==b.comments&&(a.row=a.me._getCommentsRow(b,!1),a.newDiv.down("#comments_result_div tbody").insert({bottom:a.row}))}),a.newDiv},_getOrderStatus:function(){var a={};return a.me=this,a.selBox=new Element("select",{"save-order":"status"}),a.selBox.insert({bottom:new Element("option").update(a.me._purchaseorder.status)}),a.me._statusOptions.each(function(b){a.me._purchaseorder.status!==b&&a.selBox.insert({bottom:new Element("option").update(b)})}),a.selBox},_getPaymentPanel:function(){var a={};return a.me=this,a.supplier=a.me._supplier,a.totalShippingCost=a.me._purchaseorder.shippingCost?a.me._purchaseorder.shippingCost:0,a.totalHandlingCost=a.me._purchaseorder.handlingCost?a.me._purchaseorder.handlingCost:0,a.totalExcGST=a.me._purchaseorder.totalAmount?a.me._purchaseorder.totalAmount:0,a.totalPaidAmount=a.me._purchaseorder.totalPaid?a.me._purchaseorder.totalPaid:0,a.totalPaymentDue=1*a.totalExcGST+1*a.totalShippingCost+1*a.totalHandlingCost-1*a.totalPaidAmount,a.shippingCostEl=new Element("input",{class:"text-right",id:"shipping_cost","save-order":"shippingCost",value:a.me._purchaseorder.shippingCost?a.me.getCurrency(a.me._purchaseorder.shippingCost):a.me.getCurrency(0)}).observe("keyup",function(){a.shippingCost=""===this.value?0:a.me.getValueFromCurrency(this.value),jQuery.isNumeric(a.shippingCost)&&(a.totalPaidAmount=1*a.me.getValueFromCurrency($$('[save-order="totalPaid"]').first().value),a.handlingCost=1*a.me.getValueFromCurrency($$('[save-order="handlingCost"]').first().value),a.totalExcGST=1*a.me.getValueFromCurrency($(a.me.getHTMLID("totalPriceExcludeGST")).innerHTML),a.totalPaymentDue=1*a.totalIncGST+1*a.shippingCost+1*a.handlingCost-1*a.totalPaidAmount,$$(".total-payment-due").each(function(b){a.newEl=new Element("strong",{class:"label"}).update(a.me.getCurrency(a.totalPaymentDue)+" "),1*a.totalPaymentDue>0?a.newEl.addClassName("label-info").writeAttribute("title","Need to pay supplier").insert({bottom:new Element("span",{class:" glyphicon glyphicon-import"})}):1*a.totalPaymentDue===0?a.newEl.addClassName("label-success").insert({bottom:new Element("span",{class:"glyphicon glyphicon-ok"})}):a.newEl.addClassName("label-danger").writeAttribute("title","Over paid to supplier").insert({bottom:new Element("span",{class:" glyphicon glyphicon-export"})}),b.update(a.newEl)}))}).observe("click",function(){$(this).select()}),a.handlingCostEl=new Element("input",{class:"text-right",id:"handling_cost","save-order":"handlingCost",value:a.me._purchaseorder.handlingCost?a.me.getCurrency(a.me._purchaseorder.handlingCost):a.me.getCurrency(0)}).observe("keyup",function(){a.handlingCost=""===this.value?0:a.me.getValueFromCurrency(this.value),jQuery.isNumeric(a.handlingCost)&&(a.totalPaidAmount=1*a.me.getValueFromCurrency($$('[save-order="totalPaid"]').first().value),a.shippingCost=1*a.me.getValueFromCurrency($$('[save-order="shippingCost"]').first().value),a.totalExcGST=1*a.me.getValueFromCurrency($(a.me.getHTMLID("totalPriceExcludeGST")).innerHTML),a.totalPaymentDue=1*a.totalExcGST+1*a.shippingCost+1*a.handlingCost-1*a.totalPaidAmount,$$(".total-payment-due").each(function(b){a.newEl=new Element("strong",{class:"label"}).update(a.me.getCurrency(a.totalPaymentDue)+" "),1*a.totalPaymentDue>0?a.newEl.addClassName("label-info").writeAttribute("title","Need to pay supplier").insert({bottom:new Element("span",{class:" glyphicon glyphicon-import"})}):1*a.totalPaymentDue===0?a.newEl.addClassName("label-success").insert({bottom:new Element("span",{class:"glyphicon glyphicon-ok"})}):a.newEl.addClassName("label-danger").writeAttribute("title","Over paid to supplier").insert({bottom:new Element("span",{class:" glyphicon glyphicon-export"})}),b.update(a.newEl)}))}).observe("click",function(){$(this).select()}),a.totalAmountExGstEl=new Element("input",{class:"text-right",disabled:"disabled","save-order":"totalAmount"}),a.totalPaidEl=new Element("input",{class:"text-right",id:a.me.getHTMLID("totalPaidAmount"),"save-order":"totalPaid",value:a.me._purchaseorder.totalPaid?a.me.getCurrency(a.me._purchaseorder.totalPaid):a.me.getCurrency(0)}).observe("keyup",function(){a.totalPaidAmount=""===this.value?0:a.me.getValueFromCurrency(this.value),jQuery.isNumeric(a.totalPaidAmount)&&(a.shippingCost=1*a.me.getValueFromCurrency($$('[save-order="shippingCost"]').first().value),a.handlingCost=1*a.me.getValueFromCurrency($$('[save-order="handlingCost"]').first().value),a.totalExcGST=1*a.me.getValueFromCurrency($(a.me.getHTMLID("totalPriceExcludeGST")).innerHTML),a.totalPaymentDue=1*a.totalExcGST+1*a.shippingCost+1*a.handlingCost-1*a.totalPaidAmount,$$(".total-payment-due").each(function(b){a.newEl=new Element("strong",{class:"label"}).update(a.me.getCurrency(a.totalPaymentDue)+" "),1*a.totalPaymentDue>0?a.newEl.addClassName("label-info").writeAttribute("title","Need to pay supplier").insert({bottom:new Element("span",{class:" glyphicon glyphicon-import"})}):1*a.totalPaymentDue===0?a.newEl.addClassName("label-success").insert({bottom:new Element("span",{class:"glyphicon glyphicon-ok"})}):a.newEl.addClassName("label-danger").writeAttribute("title","Over paid to supplier").insert({bottom:new Element("span",{class:" glyphicon glyphicon-export"})}),b.update(a.newEl)}))}).observe("click",function(){$(this).select()}),a.newDiv=new Element("div",{class:"panel panel-info",id:a.me.getHTMLID("paymentPanel")}).insert({bottom:new Element("div",{class:"panel-heading"}).insert({bottom:new Element("strong").update("Total Payment Due Exc. GST: ")}).insert({bottom:new Element("span",{class:"pull-right total-payment-due"}).update(a.me.getCurrency(a.totalPaymentDue))})}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-md-6"}).insert({bottom:new Element("div",{class:"list-group-item"}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-xs-6 text-left form-group",style:"margin: 0px;"}).insert({bottom:new Element("lable",{class:"text-left active"}).update(new Element("span").update("Total Ex GST"))})}).insert({bottom:new Element("div",{class:"col-xs-6 text-left form-group",style:"margin: 0px;"}).insert({bottom:a.totalAmountExGstEl.addClassName("form-control input-sm col-xs-6")})})})}).insert({bottom:new Element("div",{class:"list-group-item"}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-xs-6 text-left form-group",style:"margin: 0px;"}).insert({bottom:new Element("lable",{class:"text-left active"}).update(new Element("span").update("Total Paid"))})}).insert({bottom:new Element("div",{class:"col-xs-6 form-group",style:"margin: 0px;"}).insert({bottom:a.totalPaidEl.addClassName("form-control input-sm")})})})})}).insert({bottom:new Element("div",{class:"col-md-6"}).insert({bottom:new Element("div",{class:"list-group-item"}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-xs-6 text-left form-group",style:"margin: 0px;"}).insert({bottom:new Element("lable",{class:"text-left active"}).update(new Element("span").update("Shipping Cost"))})}).insert({bottom:new Element("div",{class:"col-xs-6 form-group",style:"margin: 0px;"}).insert({bottom:a.shippingCostEl.addClassName("form-control input-sm")})})})}).insert({bottom:new Element("div",{class:"list-group-item"}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-xs-6 text-left form-group",style:"margin: 0px;"}).insert({bottom:new Element("lable",{class:"text-left active"}).update(new Element("span").update("Handling Cost"))})}).insert({bottom:new Element("div",{class:"col-xs-6 form-group",style:"margin: 0px;"}).insert({bottom:a.handlingCostEl.addClassName("form-control input-sm")})})})})})}),a.newDiv},_getPartsTable:function(){var a={};return a.me=this,a.productListDiv=new Element("table",{class:"table table-hover table-condensed order_change_details_table"}).insert({bottom:a.me._getProductRow({product:{sku:"SKU",name:"Description"},unitPrice:"Unit Price (Ex)",qtyOrdered:"Qty",totalPrice:"Total Price",eta:"ETA"},!0).wrap(new Element("thead"))}),a.productListDiv.insert({bottom:a.tbody=new Element("tbody",{style:"border: 3px #ccc solid;"}).insert({bottom:a.me._getNewProductRow()})}),a.productListDiv.insert({bottom:a.tbody=new Element("tfoot").insert({bottom:new Element("tr").insert({bottom:new Element("td",{colspan:2,rowspan:4}).insert({bottom:a.me._getFormGroup("Comments:",new Element("textarea",{"save-order":"comments",style:"height:33px"}).update(a.me._comment?a.me._comment:""))}).insert({bottom:new Element("div",{colspan:2,class:"active"}).update(a.me._saveBtns())})}).insert({bottom:new Element("td",{colspan:2,class:"text-right active"}).update(new Element("strong").update("Total Excl. GST: "))}).insert({bottom:new Element("td",{id:a.me.getHTMLID("totalPriceExcludeGST"),class:"active"}).update(a.me.getCurrency(0))}).insert({bottom:new Element("td",{rowspan:4}).update("&nbsp;")})}).insert({bottom:new Element("tr").insert({bottom:new Element("td",{colspan:2,class:"text-right active"}).update(new Element("strong").update("Total GST: "))}).insert({bottom:new Element("td",{id:a.me.getHTMLID("totalPriceGST"),class:"active"}).update(a.me.getCurrency(0))})}).insert({bottom:new Element("tr").insert({bottom:new Element("td",{colspan:2,class:"text-right active"}).update(new Element("strong").update("Total Incl. GST: "))}).insert({bottom:new Element("td",{id:a.me.getHTMLID("totalPriceIncludeGST"),class:"active"}).update(a.me.getCurrency(0))})})}),new Element("div",{class:"panel panel-info"}).insert({bottom:new Element("div",{class:"panel-body table-responsive"}).insert({bottom:a.productListDiv})})},_getProductRow:function(a,b){var c={};return c.me=this,c.isTitle=b||!1,c.tag=c.isTitle===!0?"th":"td",c.row=new Element("tr",{class:c.isTitle===!0?"":"item_row order-item-row","item-id":a.id?a.id:""}).store("data",a).insert({bottom:new Element(c.tag,{class:"productName"}).insert({bottom:a.product.name})}).insert({bottom:new Element(c.tag,{class:"uprice col-xs-1"}).insert({bottom:a.unitPrice}).observe("keydown",function(a){return c.txtBox=this,c.me.keydown(a,function(){$(c.txtBox).up(".item_row").down(".tprice input").value=c.me.getCurrency($(c.txtBox).down("input").value),$(c.txtBox).up(".item_row").down(".glyphicon.glyphicon-floppy-saved").click()}),!1})}).insert({bottom:new Element(c.tag,{class:"qty col-xs-1"}).insert({bottom:a.receievedQty&&"NEW"!==c.me._purchaseorder.status?a.receievedQty+"/"+a.qtyOrdered:a.qtyOrdered}).observe("keydown",function(a){return c.txtBox=this,c.me.keydown(a,function(){$(c.txtBox).up(".item_row").down(".glyphicon.glyphicon-floppy-saved").click()}),!1})}).insert({bottom:new Element(c.tag,{class:"tprice col-xs-1"}).insert({bottom:a.totalPrice}).observe("keydown",function(a){return c.txtBox=this,c.me.keydown(a,function(){$(c.txtBox).up(".item_row").down(".glyphicon.glyphicon-floppy-saved").click()}),!1})}).insert({bottom:new Element(c.tag,{class:"eta col-xs-1"}).insert({bottom:a.eta}).observe("keydown",function(a){return c.txtBox=this,c.me.keydown(a,function(){$(c.txtBox).up(".item_row").down(".glyphicon.glyphicon-floppy-saved").click()}),!1})}).insert({bottom:new Element(c.tag,{class:"btns  col-xs-1"}).update(a.btns?a.btns:"")}),a.product.sku?c.row.insert({top:new Element(c.tag,{class:"productSku"}).update(a.product.sku)}):c.row.down(".productName").writeAttribute("colspan",2),c.row},_getNewProductRow:function(){var a={};return a.me=this,a.skuAutoComplete=a.me._getNewProductProductAutoComplete(),a.data={product:{name:a.skuAutoComplete},unitPrice:a.me._getFormGroup(null,new Element("input",{class:"input-sm","new-order-item":"unitPrice",required:"Required!",value:a.me.getCurrency(0)}).observe("keyup",function(){a.row=$(this).up(".item_row"),a.unitPrice=a.me.getValueFromCurrency($F(this)),a.qty=$F(a.row.down("[new-order-item=qtyOrdered]")),$(a.row.down("[new-order-item=totalPrice]")).value=a.me.getCurrency(a.unitPrice*a.qty)}).observe("click",function(){$(this).select()})),qtyOrdered:a.me._getFormGroup(null,new Element("input",{class:"input-sm",type:"number","new-order-item":"qtyOrdered",required:"Required!",value:"1"}).observe("keyup",function(){a.row=$(this).up(".item_row"),a.unitPrice=a.me.getValueFromCurrency($F(a.row.down("[new-order-item=unitPrice]"))),a.qty=$F(this),$(a.row.down("[new-order-item=totalPrice]")).value=a.me.getCurrency(a.unitPrice*a.qty)}).observe("change",function(){a.row=$(this).up(".item_row"),a.unitPrice=a.me.getValueFromCurrency($F(a.row.down("[new-order-item=unitPrice]"))),a.qty=$F(this),$(a.row.down("[new-order-item=totalPrice]")).value=a.me.getCurrency(a.unitPrice*a.qty)}).observe("click",function(){$(this).select()})),totalPrice:a.me._getFormGroup(null,new Element("input",{class:"input-sm",disabled:!0,"new-order-item":"totalPrice",required:"Required!",value:a.me.getCurrency(0)}).observe("keyup",function(){a.row=$(this).up(".item_row"),a.totalPrice=a.me.getValueFromCurrency($F(this)),a.qty=$F(a.row.down("[new-order-item=qtyOrdered]")),$(a.row.down("[new-order-item=unitPrice]")).value=a.me.getCurrency(a.totalPrice/a.qty)}).observe("click",function(){$(this).select()})),eta:a.me._getFormGroup(null,new Element("input",{class:"input-sm datepicker","new-order-item":"eta","save-order":"ETA",value:""}).observe("keyup",function(){a.row=$(this).up(".item_row"),a.eta=$F(this)}).observe("click",function(a){$(this).select()})),btns:new Element("span",{class:"btn-group btn-group-sm pull-right"}).insert({bottom:new Element("span",{class:"btn btn-primary"}).insert({bottom:new Element("span",{class:" glyphicon glyphicon-floppy-saved"})}).observe("click",function(){a.me._addNewProductRow(this),a.me._loadDataPicker()})}).insert({bottom:new Element("span",{class:"btn btn-default"}).insert({bottom:new Element("span",{class:"glyphicon glyphicon-floppy-remove"})}).observe("click",function(){confirm("You about to clear this entry. All input data for this entry will be lost.\n\nContinue?")&&(a.newRow=a.me._getNewProductRow(),a.currentRow=$(this).up(".new-order-item-input"),a.currentRow.getElementsBySelector(".form-group.has-error .form-control").each(function(a){$(a).retrieve("clearErrFunc")()}),a.currentRow.replace(a.newRow),a.newRow.down("[new-order-item=product]").focus())})})},a.me._getProductRow(a.data,!1).addClassName("new-order-item-input info").removeClassName("order-item-row")},_getNewProductProductAutoComplete:function(){var a={};return a.me=this,a.skuAutoComplete=a.me._getFormGroup(null,new Element("div",{class:"input-group input-group-sm product-autocomplete"}).insert({bottom:new Element("input",{class:"form-control search-txt visible-xs visible-sm visible-md visible-lg","new-order-item":"product",required:"Required!",placeholder:"search SKU, NAME and any BARCODE for this product"}).observe("keydown",function(b){return a.txtBox=this,a.me.keydown(b,function(){$(a.txtBox).up(".product-autocomplete").down(".search-btn").click()}),a.me.keydown(b,function(){$(a.txtBox).up(".product-autocomplete").down(".search-btn").click()},null,9),!1}).observe("click",function(){$(this).select()})}).insert({bottom:new Element("span",{class:"input-group-btn"}).insert({bottom:new Element("span",{class:" btn btn-primary search-btn","data-loading-text":"searching..."}).insert({bottom:new Element("span",{class:"glyphicon glyphicon-search"})}).observe("click",function(){a.me._searchProduct(this)})})})),a.skuAutoComplete.down(".input-group").removeClassName("form-control"),a.skuAutoComplete},_recalculateSummary:function(a){var b={};return b.me=this,b.totalIncGSTBox=$(b.me.getHTMLID("totalPriceIncludeGST"))?$(b.me.getHTMLID("totalPriceIncludeGST")):b.me._newDiv.down("#"+b.me.getHTMLID("totalPriceIncludeGST")),b.totalGSTBox=$(b.me.getHTMLID("totalPriceGST"))?$(b.me.getHTMLID("totalPriceGST")):b.me._newDiv.down("#"+b.me.getHTMLID("totalPriceGST")),b.totalExcGSTBox=$(b.me.getHTMLID("totalPriceExcludeGST"))?$(b.me.getHTMLID("totalPriceExcludeGST")):b.me._newDiv.down("#"+b.me.getHTMLID("totalPriceExcludeGST")),b.totalShippingCostBox=$("shipping_cost"),b.totalHandlingCostBox=$("handling_cost"),b.totalExcGST=1*b.me.getValueFromCurrency(b.totalExcGSTBox.innerHTML)+1*a,b.totalIncGST=b.totalExcGST?1*b.totalExcGST*1.1:0,b.totalShippingCost=b.totalShippingCostBox?b.me.getValueFromCurrency($F(b.totalShippingCostBox)):b.me._purchaseorder.shippingCost,b.totalHandlingCost=b.totalHandlingCostBox?b.me.getValueFromCurrency($F(b.totalHandlingCostBox)):b.me._purchaseorder.handlingCost,b.totalGST=b.totalExcGST?1*b.totalIncGST-1*b.totalExcGST:0,b.totalIncGSTBox.update(b.me.getCurrency(b.totalIncGST)),b.totalGSTBox.update(b.me.getCurrency(b.totalGST)),b.totalExcGSTBox.update(b.me.getCurrency(b.totalExcGST)),b.totalPaidAmount=$$(".pull-right.total-payment-due").first()?$(b.me.getHTMLID("totalPaidAmount"))?b.me.getValueFromCurrency($F(b.me.getHTMLID("totalPaidAmount"))):0:b.me._purchaseorder.totalPaid,b.totalPaymentDue=1*b.totalExcGST+1*b.totalShippingCost+1*b.totalHandlingCost-1*b.totalPaidAmount,$$(".total-payment-due").each(function(a){b.newEl=new Element("strong",{class:"label"}).update(b.me.getCurrency(b.totalPaymentDue)+" "),1*b.totalPaymentDue>0?b.newEl.addClassName("label-info").writeAttribute("title","Need to pay supplier").insert({bottom:new Element("span",{class:" glyphicon glyphicon-import"})}):1*b.totalPaymentDue===0?b.newEl.addClassName("label-success").insert({bottom:new Element("span",{class:"glyphicon glyphicon-ok"})}):b.newEl.addClassName("label-danger").writeAttribute("title","Over paid to supplier").insert({bottom:new Element("span",{class:" glyphicon glyphicon-export"})}),a.update(b.newEl)}),$$(".pull-right.total-payment-due").first()||b.me._newDiv.getElementsBySelector(".total-payment-due").each(function(a){b.newEl=new Element("strong",{class:"label"}).update(b.me.getCurrency(b.totalPaymentDue)+" "),1*b.totalPaymentDue>0?b.newEl.addClassName("label-info").writeAttribute("title","Need to pay supplier").insert({bottom:new Element("span",{class:" glyphicon glyphicon-import"})}):1*b.totalPaymentDue===0?b.newEl.addClassName("label-success").insert({bottom:new Element("span",{class:"glyphicon glyphicon-ok"})}):b.newEl.addClassName("label-danger").writeAttribute("title","Over paid to supplier").insert({bottom:new Element("span",{class:" glyphicon glyphicon-export"})}),a.update(b.newEl)}),$$("#"+b.me.getHTMLID("paymentPanel")).first()?$$("#"+b.me.getHTMLID("paymentPanel")).first().down('[save-order]="totalAmount"[disabled]="disabled"').value=b.me.getCurrency(b.totalExcGST):b.me._newDiv.down('[save-order]="totalAmount"[disabled]="disabled"').value=b.me.getCurrency(b.totalExcGST),b.me},_addNewProductRow:function(a,b){var c={};return c.me=this,c.currentRow=$(a).up(".new-order-item-input"),c.product="undefined"==typeof b?c.currentRow.retrieve("product"):b.product,c.product?(c.unitPriceBox=c.currentRow.down("[new-order-item=unitPrice]"),c.unitPrice="undefined"==typeof b?c.me.getValueFromCurrency($F(c.unitPriceBox)):b.unitPrice,jQuery.isNumeric(c.unitPrice)||null!==c.unitPrice.match(/^\d+(\.\d{1,2})?$/)?(c.qtyOrderedBox=c.currentRow.down("[new-order-item=qtyOrdered]"),c.qtyOrdered="undefined"==typeof b?c.me.getValueFromCurrency($F(c.qtyOrderedBox)):b.qty,null===c.qtyOrdered.match(/^(-)?\d+(\.\d{1,2})?$/)?void c.me._markFormGroupError(c.qtyOrderedBox,"Invalid value provided!"):(c.receievedQty="undefined"==typeof b?"":b.receievedQty,c.totalPriceBox=c.currentRow.down("[new-order-item=totalPrice]"),c.totalPrice="undefined"==typeof b?c.me.getValueFromCurrency($F(c.totalPriceBox)):b.totalPrice,jQuery.isNumeric(c.totalPrice)||null!==c.totalPrice.match(/^\d+(\.\d{1,2})?$/)?(c.etaBox=c.currentRow.down("[new-order-item=eta]"),c.eta="undefined"==typeof b?$F(c.etaBox):b.eta,""===c.eta&&"purchase/new.html"==window.location.pathname?void c.me._markFormGroupError(c.etaBox,"Invalid value provided!"):(c.currentRow.getElementsBySelector(".form-group.has-error .form-control").each(function(a){$(a).retrieve("clearErrFunc")()}),c.data={id:b&&b.id?b.id:"",product:c.product,unitPrice:c.me.getCurrency(c.unitPrice),qtyOrdered:c.qtyOrdered,receievedQty:c.receievedQty,totalPrice:c.me.getCurrency(c.totalPrice),eta:c.eta,btns:new Element("span",{class:"pull-right",style:"NEW"!==c.me._purchaseorder.status?"display:none":""}).insert({bottom:new Element("span",{class:"btn btn-danger btn-xs"}).insert({bottom:new Element("span",{class:"glyphicon glyphicon-trash"})}).observe("click",function(){confirm("You remove this entry.\n\nContinue?")&&(c.row=$(this).up(".item_row"),c.me._recalculateSummary(0-1*c.me.getValueFromCurrency(c.row.retrieve("data").totalPrice)),c.row.hasClassName("order-item-row-old")?(c.row.addClassName("order-item-row-old-removed"),c.row.hide()):c.row.remove())})})},c.currentRow.insert({after:c.productRow=c.me._getProductRow(c.data).addClassName("btn-hide-row")}),c.me.setProductLink(c.productRow.down(".productSku"),c.product.id),c.newRow=c.me._getNewProductRow(),c.currentRow.replace(c.newRow),c.newRow.down("[new-order-item=product]").focus(),c.me._recalculateSummary(c.totalPrice),c.me)):void c.me._markFormGroupError(c.totalPriceBox,"Invalid value provided!"))):void c.me._markFormGroupError(c.unitPriceBox,"Invalid value provided!")):(c.productBox=c.currentRow.down("[new-order-item=product]"),void(c.currentRow.down("[new-order-item=product]")?c.me._markFormGroupError(c.productBox,"Select a product first!"):c.me.showModalBox("Product Needed","Select a product first!",!0)))},setProductLink:function(a,b){var c={};c.me=this,$(a).setStyle("text-decoration: underline; cursor: pointer;").writeAttribute("title","double click to open").observe("click",function(a){Event.stop(a)}).observe("dblclick",function(a){Event.stop(a),c.window=window.open("/product/"+b+".html","_blank"),c.window.focus()})},_searchProduct:function(a){var b={};return b.me=this,b.btn=a,b.me._signRandID(b.btn),b.searchTxtBox=$(b.btn).up(".product-autocomplete").down(".search-txt"),b.searchTxt=$F(b.searchTxtBox),b.me.postAjax(b.me.getCallbackId("searchProduct"),{searchTxt:b.searchTxt,supplierID:b.me._supplier.id},{onLoading:function(){jQuery("#"+b.btn.id).button("loading")},onSuccess:function(a,c){b.resultList=new Element("div",{style:"overflow: auto; max-height: 400px;"});try{if(b.result=b.me.getResp(c,!1,!0),!b.result||!b.result.items||0===b.result.items.size())throw"Nothing Found for: "+b.searchTxt;b.me._signRandID(b.searchTxtBox),b.result.items.each(function(a){b.resultList.insert({bottom:b.me._getSearchPrductResultRow(a,b.searchTxtBox)})}),b.resultList.addClassName("list-group")}catch(a){b.resultList.update(b.me.getAlertBox("Error: ",a).addClassName("alert-danger"))}b.me.showModalBox("Products that has: "+b.searchTxt,b.resultList,!1)},onComplete:function(a,c){jQuery("#"+b.btn.id).button("reset")}}),b.me},_getSearchPrductResultRow:function(a,b){var c={};return c.me=this,c.defaultImgSrc="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCI+PHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjZWVlIi8+PHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMzIiIHk9IjMyIiBzdHlsZT0iZmlsbDojYWFhO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjEycHg7Zm9udC1mYW1pbHk6QXJpYWwsSGVsdmV0aWNhLHNhbnMtc2VyaWY7ZG9taW5hbnQtYmFzZWxpbmU6Y2VudHJhbCI+NjR4NjQ8L3RleHQ+PC9zdmc+",c.newRow=new Element("a",{class:"list-group-item",href:"javascript: void(0);"}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-xs-2"}).insert({bottom:new Element("div",{class:"thumbnail"}).insert({bottom:new Element("img",{"data-src":"holder.js/100%x64",alert:"Product Image",src:0===a.images.size()?c.defaultImgSrc:a.images[0].asset.url})})})}).insert({bottom:new Element("div",{class:"col-xs-10"}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("strong").update(a.name).insert({bottom:new Element("small",{class:"btn btn-xs btn-info"}).insert({bottom:new Element("small",{class:"glyphicon glyphicon-new-window"})})}).observe("click",function(b){Event.stop(b),c.window=window.open("/product/"+a.id+".html","_blank"),c.window.focus()}).insert({bottom:new Element("small",{class:"pull-right"}).update("SKU: "+a.sku)})}).insert({bottom:new Element("div").insert({bottom:new Element("small").update(a.shortDescription)})})}).insert({bottom:new Element("div",{class:"row",style:a.minProductPrice||a.lastSupplierPrice||a.minSupplierPrice?"height: 2px; background-color: brown;":"display:none"}).update("&nbsp;")}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("span",{class:"btn btn-link btn-xs",style:a.minProductPrice?"text-align: left":"display:none"}).update("Product Min: ").insert({bottom:new Element("strong").update(c.me.getCurrency(a.minProductPrice))}).writeAttribute("title","double click to open").observe("click",function(a){Event.stop(a)}).observe("dblclick",function(b){Event.stop(b),c.me._openPOPage(a.minProductPriceId)})}).insert({bottom:new Element("span",{class:"btn btn-link btn-xs",style:a.minSupplierPrice?"text-align: left":"display:none"}).update("Supplier Min: ").insert({bottom:new Element("strong").update(c.me.getCurrency(a.minSupplierPrice))}).writeAttribute("title","double click to open").observe("click",function(a){Event.stop(a)}).observe("dblclick",function(b){Event.stop(b),c.me._openPOPage(a.minSupplierPriceId)})}).insert({bottom:new Element("span",{class:"btn btn-link btn-xs",style:a.lastSupplierPrice?"text-align: left":"display:none"}).update("Supplier Last: ").insert({bottom:new Element("strong").update(c.me.getCurrency(a.lastSupplierPrice))}).writeAttribute("title","double click to open").observe("click",function(a){Event.stop(a)}).observe("dblclick",function(b){Event.stop(b),c.me._openPOPage(a.lastSupplierPriceId)})}).insert({bottom:new Element("span",{class:"btn btn-xs pull-right",title:"Stock on Hand"}).setStyle("text-align: left;").update("SoH: ").insert({bottom:new Element("strong").update(a.stockOnHand)})}).insert({bottom:new Element("span",{class:"btn btn-xs pull-right",title:"Stock on PO"}).setStyle("text-align: left;").update("SoPO: ").insert({bottom:new Element("strong").update(a.stockOnPO)})})})})}).observe("click",function(){c.inputRow=$(b).up(".new-order-item-input").store("product",a),b.up(".productName").writeAttribute("colspan",!1).update(a.sku).setStyle("text-decoration: underline; cursor: pointer;").observe("click",function(b){
Event.stop(b),c.window=window.open("/product/"+a.id+".html","_blank"),c.window.focus()}).insert({after:new Element("td").update(a.name).insert({bottom:new Element("a",{href:"javascript: void(0);",class:"text-danger pull-right",title:"click to change the product"}).insert({bottom:new Element("span",{class:"glyphicon glyphicon-remove"})}).observe("click",function(){c.newRow=c.me._getNewProductRow(),$(this).up(".new-order-item-input").replace(c.newRow),c.newRow.down("[new-order-item=product]").select()})})}),jQuery("#"+c.me.modalId).modal("hide"),c.inputRow.down("[new-order-item=totalPrice]").value=c.me.getCurrency(a.minProductPrice),c.inputRow.down("[new-order-item=qtyOrdered]").value=1,c.inputRow.down("[new-order-item=unitPrice]").value=c.me.getCurrency(a.minProductPrice),c.inputRow.down("[new-order-item=unitPrice]").select()}),c.newRow},_saveBtns:function(){var a={};return a.me=this,a.newDiv=new Element("span",{class:"btn-group pull-right"}).insert({bottom:new Element("span",{class:"btn btn-primary","data-loading-text":"saving..."}).insert({bottom:new Element("span",{class:"glyphicon glyphicon-ok-circle"})}).insert({bottom:new Element("span").update(" save ")}).observe("click",function(){a.me._submitOrder($(this))})}).insert({bottom:new Element("span",{class:"NEW"===a.me._purchaseorder.status?"btn btn-info":"hidden","data-loading-text":"saving..."}).insert({bottom:new Element("span",{class:"glyphicon glyphicon-send"})}).insert({bottom:new Element("span").update(" submit ")}).observe("click",function(){a.selBox=new Element("select",{"save-order":"status"}),a.selBox.insert({bottom:new Element("option").update("ORDERED")}),a.me._statusOptions.each(function(b){"ORDERED"!==a.me._purchaseorder.status&&a.selBox.insert({bottom:new Element("option").update(b)})}),$$('select[save-order="status"]').first().replace(a.selBox),a.me._submitOrder($(this),!0)})}).insert({bottom:new Element("span",{class:"btn btn-success"}).insert({bottom:new Element("span",{class:""}).update("Print Order ")}).insert({bottom:new Element("span",{class:"glyphicon glyphicon-print"})}).observe("click",function(){a.me._openOrderPrintPage()})}).insert({bottom:new Element("span",{class:"btn btn-default"}).insert({bottom:new Element("span",{class:"glyphicon glyphicon-remove-sign"})}).insert({bottom:new Element("span").update(" cancel ")}).observe("click",function(){a.me.showModalBox('<strong class="text-danger">Cancelling the current order</strong>','<div>You are about to cancel this new order, all input data will be lost.</div><br /><div>Continue?</div><div><span class="btn btn-primary" onclick="window.location = document.URL;"><span class="glyphicon glyphicon-ok"></span> YES</span><span class="btn btn-default pull-right" data-dismiss="modal"><span aria-hidden="true"><span class="glyphicon glyphicon-remove-sign"></span> NO</span></span></div>',!0)})}),a.newDiv=a.newDiv.wrap(new Element("div")),a.newDiv.insert({top:!a.me._purchaseorder.id||"ORDERED"!==a.me._purchaseorder.status&&"RECEIVING"!==a.me._purchaseorder.status||a.me._purchaseorder.active!==!0?"":new Element("a",{class:"btn btn-success pull-left",title:"Receiving Items",href:"/receiving/"+a.me._purchaseorder.id+".html"}).update("Receiving")}),a.newDiv},_submitOrder:function(a,b){var c={};return c.me=this,c.btn=a,c.isSubmit=b===!0,c.data=c.me._collectFormData($(c.me.getHTMLID("itemDiv")),"save-order"),null===c.data?c.me:(c.data.items=[],$$(".order-item-row").each(function(a){c.item=a.retrieve("data"),c.data.items.push({id:c.item.id,productId:c.item.product.id,qtyOrdered:c.item.qtyOrdered,totalPrice:c.item.totalPrice?c.me.getValueFromCurrency(c.item.totalPrice):"",unitPrice:c.item.unitPrice?c.me.getValueFromCurrency(c.item.unitPrice):"",eta:c.item.eta,active:!a.hasClassName("order-item-row-old-removed")})}),c.data.id=c.me._purchaseorder.id,c.data.supplierId=c.me._supplier.id,c.data.totalAmount=c.data.totalAmount?c.me.getValueFromCurrency($(c.me.getHTMLID("totalPriceIncludeGST")).innerHTML):"",c.data.totalPaid=c.data.totalPaid?c.me.getValueFromCurrency(c.data.totalPaid):"",c.data.handlingCost=c.data.handlingCost?c.me.getValueFromCurrency(c.data.handlingCost):"",c.data.shippingCost=c.data.shippingCost?c.me.getValueFromCurrency(c.data.shippingCost):"",c.me._signRandID(c.btn),c.data.isSubmit=c.isSubmit,c.me.postAjax(c.me.getCallbackId("saveOrder"),c.data,{onLoading:function(a,b){jQuery("#"+c.btn.id).button("loading")},onSuccess:function(a,b){try{if(c.result=c.me.getResp(b,!1,!0),!c.result||!c.result.item)return;c.me._item=c.result.item,c.me.refreshParentWindow(),c.me.showModalBox("Success","Saved successfully",!1),location.reload()}catch(a){c.me.showModalBox("Error!",a,!1)}},onComplete:function(a,b){jQuery("#"+c.btn.id).button("reset")}}),c.me)},_openPOPage:function(a){var b={};return b.me=this,b.newWindow=window.open("/purchase/"+a+".html","width=1300, location=no, scrollbars=yes, menubar=no, status=no, titlebar=no, fullscreen=no, toolbar=no"),b.newWindow.focus(),b.me},refreshParentWindow:function(){var a={};a.me=this,window.opener&&(a.parentWindow=window.opener,a.row=$(a.parentWindow.document.body).down("#"+a.parentWindow.pageJs.resultDivId+" .item_row[item_id="+a.me._item.id+"]"),a.row&&a.row.replace(a.parentWindow.pageJs._getResultRow(a.me._item)))},_getSummaryDiv:function(a){var b={};return b.me=this,b.item=a,b.statusOptionSel=new Element("select",{class:"","save-item":"status"}).insert({bottom:new Element("option",{value:b.item.status}).update(b.item.status)}),b.me._statusOptions.each(function(a){a!==b.item.status&&b.statusOptionSel.insert({bottom:new Element("option",{value:a}).update(a)})}),b.newDiv=new Element("div",{class:"panel panel-default purchaseorder-summary"}).insert({bottom:new Element("div",{class:"panel-heading"}).insert({bottom:new Element("a",{href:"javascript: void(0);",title:"click to show/hide below"}).insert({bottom:new Element("strong").update(b.item.supplier.name?"Editing: "+b.item.supplier.name+" - "+b.item.id:"Creating new purchase order: ")}).insert({bottom:new Element("small",{class:"pull-right"}).insert({bottom:new Element("label",{for:"showOnWeb_"+b.item.id}).update("Show on Web?")}).insert({bottom:new Element("input",{id:"showOnWeb_"+b.item.id,style:"margin-left:10px;","save-item":"sellOnWeb",type:"checkbox"})})})}).observe("click",function(){$(this).up(".panel").down(".panel-body").toggle()})}).insert({bottom:new Element("div",{class:"panel-body"}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("strong",{class:"col-sm-4 pull-left"}).update("Purchase Order Info")})}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-sm-1 purchaseOrderNo"}).update(b.me._getFormGroup("PO Number",new Element("input",{disabled:"disabled",type:"value",value:b.item.purchaseOrderNo?b.item.purchaseOrderNo:""})))}).insert({bottom:new Element("div",{class:"col-sm-1 purchaseRefNo"}).update(b.me._getFormGroup("PO RefNumber",new Element("input",{"save-item":"purchaseRefNo",type:"value",value:b.item.supplierRefNo?b.item.supplierRefNo:""})))}).insert({bottom:new Element("div",{class:"col-sm-1 status"}).update(b.me._getFormGroup("Status",b.statusOptionSel))}).insert({bottom:new Element("div",{class:"col-sm-1 active"}).update(b.me._getFormGroup("Active?",new Element("input",{"save-item":"active",type:"checkbox",checked:b.item.active})))}).insert({bottom:new Element("div",{class:"col-sm-2 orderDate"}).update(b.me._getFormGroup("Ordered Date",new Element("input",{class:"datepicker","save-item":"orderDate",value:b.item.orderDate?b.item.orderDate:""})))})}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("strong",{class:"col-sm-4 pull-left"}).update("Supplier Info")})}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-sm-1 supplierName"}).update(b.me._getFormGroup("Name",new Element("input",{"save-item":"supplierName",type:"text",value:b.item.supplier.name?b.item.supplier.name:""})))}).insert({bottom:new Element("div",{class:"col-sm-1 supplierId"}).update(b.me._getFormGroup("ID",new Element("input",{"save-item":"supplierId",type:"text",value:b.item.supplier.id?b.item.supplier.id:""})))}).insert({bottom:new Element("div",{class:"col-sm-1 supplierMageId"}).update(b.me._getFormGroup("Mage ID",new Element("input",{"save-item":"supplierMageId",type:"value",value:b.item.supplier.mageId?b.item.supplier.mageId:""})))}).insert({bottom:new Element("div",{class:"col-sm-1 supplierActive"}).update(b.me._getFormGroup("Active?",new Element("input",{"save-item":"supplierActive",type:"checkbox",checked:b.item.supplier.active})))}).insert({bottom:new Element("div",{class:"col-sm-1 supplierContactName"}).update(b.me._getFormGroup("contactName",new Element("input",{"save-item":"supplierContactName",type:"text",value:b.item.supplierContact?b.item.supplierContact:""})))}).insert({bottom:new Element("div",{class:"col-sm-1 supplierContactNo"}).update(b.me._getFormGroup("Contact No",new Element("input",{"save-item":"supplierContactNo",type:"value",value:b.item.supplierContactNumber?b.item.supplierContactNumber:""})))})}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("strong",{class:"col-sm-4 pull-left"}).update("Finance Info")})}).insert({bottom:new Element("div",{class:"row"}).insert({bottom:new Element("div",{class:"col-sm-1 totalAmount"}).update(b.me._getFormGroup("Total Amount",new Element("input",{"save-item":"totalAmount",type:"value",value:b.item.totalAmount?b.item.totalAmount:""})))}).insert({bottom:new Element("div",{class:"col-sm-1 totalPaid"}).update(b.me._getFormGroup("Total Paid",new Element("input",{style:b.item.totalAmount-b.item.totalPaid?"color: red":"","save-item":"totalPaid",type:"value",value:b.item.totalPaid?b.item.totalPaid:""})))})})}),b.newDiv},_getFormGroup:function(a,b){return new Element("div",{class:"form-group"}).insert({bottom:a?new Element("label",{class:"control-label"}).update(a):""}).insert({bottom:b.addClassName("form-control")})},bindAllEventNObjects:function(){var a={};return a.me=this,a.me},load:function(){var a={};return a.me=this,a.newDiv=a.me._getItemDiv(),$(a.me.getHTMLID("itemDiv")).update(a.newDiv),"NEW"!==a.me._purchaseorder.status&&($$(".order_change_details_table").first().down(".new-order-item-input ").remove(),a.tableHead=$$(".order_change_details_table").first().down("tr"),a.tableHead.addClassName("info").setStyle({border:"3px solid #ccc"})),$(a.me.getHTMLID("itemDiv")).down('input[save-order="contactName"]').focus(),$(a.me.getHTMLID("itemDiv")).down('input[save-order="contactName"]').select(),"RECEIVED"!==a.me._purchaseorder.status&&"CLOSED"!==a.me._purchaseorder.status||($$("input").each(function(a){a.disabled=!0}),$$("select").each(function(a){a.disabled=!0}),"CLOSED"!==a.me._purchaseorder.status&&($("total-paid-amount").disabled=!1,$$('select[save-order="status"]').each(function(a){a.disabled=!1}))),a.me}});