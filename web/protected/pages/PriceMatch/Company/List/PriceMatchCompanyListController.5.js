var PageJs=new Class.create();PageJs.prototype=Object.extend(new BPCPageJs(),{_resultDivId:"",_addCompanyDivId:"",_pageInfo:{pageNo:1,pageSize:30},_searchCriteria:"",_getEditAliasRow:function(b){var a={};a.me=this;a.editRow=new Element("div",{"class":"input-group input-group-sm pmc_row"}).insert({bottom:new Element("span",{"class":"input-group-btn",title:"Save"}).insert({bottom:new Element("span",{id:"save_btn_"+b.id,"class":"btn btn-success","data-loading-text":"saving..."}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-floppy-saved"})})}).observe("click",function(){a.btn=this;a.aliasRow=$(a.btn).up(".pmc_row");a.newAlias=$F(a.aliasRow.down(".aliasValue"));if(a.newAlias.blank()){a.aliasRow.addClassName("has-error");a.aliasRow.insert({after:a.me.getAlertBox("Error:","Alias is required").addClassName("alert-danger")});return}a.data={id:(b.id||""),newAliasValue:a.newAlias,companyName:(b.companyName||$F(a.aliasRow.up(".company_row").down(".company_name")))};a.me.postAjax(a.me.getCallbackId("updatePriceMatchCompany"),a.data,{onLoading:function(c,d){jQuery(a.btn.id).button("loading")},onSuccess:function(c,f){try{a.result=a.me.getResp(f,false,true);a.companyNameBox=a.aliasRow.up(".company_row").down(".company_name");if(a.companyNameBox&&!a.companyNameBox.hasClassName("noborder")){a.companyNameBox.writeAttribute("readOnly",true).addClassName("noborder")}a.aliasRow.replace(a.me._getAliasRow(a.result.item))}catch(d){a.aliasRow.insert({after:a.me.getAlertBox("Error:",d).addClassName("alert-danger")})}},onComplete:function(c,d){jQuery(a.btn.id).button("reset")}})})}).insert({bottom:new Element("input",{type:"text","class":"form-control aliasValue",value:(b.companyAlias||"")})}).insert({bottom:new Element("span",{"class":"input-group-btn",title:"Cancel"}).insert({bottom:new Element("span",{"class":"btn btn-warning"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-floppy-remove"})})}).observe("click",function(){if(b.id){$(this).up(".pmc_row").replace(a.me._getAliasRow(b))}else{$(this).up(".pmc_row").remove()}})});return a.editRow},_getAliasRow:function(b){var a={};a.me=this;a.id=b.id;a.alias=b.companyAlias;if(a.alias&&a.alias!==""&&a.alias!==null&&a.alias!==undefined){return new Element("div",{"class":"input-group input-group-sm pmc_row"}).store("data",b).insert({bottom:new Element("span",{"class":"input-group-btn",title:"Edit"}).insert({bottom:new Element("span",{"class":"btn btn-default"}).update(new Element("span",{"class":"glyphicon glyphicon-pencil"}))}).observe("click",function(){a.editBtn=this;a.originalRow=$(a.editBtn).up(".pmc_row");a.editRow=a.me._getEditAliasRow(a.originalRow.retrieve("data"));a.originalRow.replace(a.editRow);a.editRow.down(".aliasValue").select()})}).insert({bottom:new Element("div",{"class":"form-control"}).update(a.alias)}).insert({bottom:new Element("span",{"class":"input-group-btn",title:"Delete"}).insert({bottom:new Element("span",{"class":"btn btn-danger"}).update(new Element("span",{"class":"glyphicon glyphicon-trash"}))}).observe("click",function(){a.confirmation=confirm("Are you sure you want to delete this alias ?");if(a.confirmation===false){return}a.aliasRow=$(this).up(".pmc_row");a.me.postAjax(a.me.getCallbackId("deleteAliasForPriceMatchCompany"),{data:b},{onLoading:function(c,d){},onSuccess:function(c,f){try{a.result=a.me.getResp(f,false,true);a.companyRow=a.aliasRow.up(".company_row");a.aliasRow.remove();if(a.companyRow.getElementsBySelector(".pmc_row").size()===0){a.companyRow.remove()}}catch(d){alert(d)}}})})})}},_getCompanyRow:function(b){var a={};a.me=this;a.aliasCol=new Element("div",{"class":"col-xs-8 company_alias"});b.companyAliases.each(function(c){a.aliasCol.insert({bottom:a.me._getAliasRow(c)})});a.aliasCol.insert({bottom:new Element("botton",{"class":"btn btn-success btn-xs"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-plus-sign"})}).observe("click",function(){$(this).insert({before:a.me._getEditAliasRow({})})})});a.companyName=new Element("input",{"class":"company_name",type:"text",value:b.companyName});if(!b.companyName.blank()){a.companyName.writeAttribute("readOnly",true).addClassName("noborder")}return new Element("div",{"class":"row list-group-item company_row"}).store("allCompanyAliasData",b).insert({bottom:new Element("div",{"class":"col-xs-4"}).update(a.companyName)}).insert({bottom:a.aliasCol})},displayAllPriceMatchCompany:function(){var a={};a.me=this;a.me.postAjax(a.me.getCallbackId("getPriceMatchCompany"),{searchCriteria:a.me._searchCriteria,pagination:a.me._pageInfo},{onLoading:function(b,c){},onSuccess:function(b,d){try{a.result=a.me.getResp(d,false,true);a.result.items.each(function(e){$(a.me._resultDivId).insert({bottom:a.me._getCompanyRow(e)})})}catch(c){alert(c)}}});return a.me},newCompany:function(){var a={};a.me=this;$(a.me._resultDivId).insert({bottom:a.me._getCompanyRow({companyName:"",companyAliases:[]})});return this}});