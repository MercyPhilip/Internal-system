var PageJs=new Class.create();PageJs.prototype=Object.extend(new BPCPageJs(),{_resultDivId:"",_addCompanyDivId:"",_pageInfo:{pageNo:1,pageSize:30},_searchCriteria:"",_getFieldDiv:function(b,a){return new Element("span",{"class":"fieldDiv"}).insert({bottom:new Element("span",{"class":"fieldDiv_title"}).update(b)}).insert({bottom:new Element("span",{"class":"fieldDiv_content"}).update(a)})},_generateEditOptions:function(a){var b={};b.me=this;b.parentRow=$(a).up(".pmc_row");b.aliasTextSpan=b.parentRow.getElementsBySelector(".single_alias")[0];b.aliasText=b.aliasTextSpan.innerHTML;b.aliasTextSpan.update(new Element("input",{type:"text","class":"alias_text_box"}).writeAttribute("value",b.aliasText));$(a).up(".single_alias_option").update("").insert({bottom:new Element("span",{"class":"button"}).update("Save").observe("click",function(){b.newAliasValue=$F($(this).up(".pmc_row").getElementsBySelector(".single_alias .alias_text_box")[0]);b.newAliasValue=b.newAliasValue.strip();if(b.newAliasValue===""||b.newAliasValue===null||b.newAliasValue===undefined||!b.newAliasValue){alert("Empty Alias value NOT Accepted");return}b.aliasObj=$(this).up(".pmc_row").retrieve("data");if(b.aliasObj.alias.strip()===b.newAliasValue){$(this).up(".pmc_row").replace(b.me._getAliasRow(b.aliasObj));return}b.me.postAjax(b.me.getCallbackId("updatePriceMatchCompany"),{id:b.aliasObj.id,newAliasValue:b.newAliasValue},{onLoading:function(c,d){},onComplete:function(c,f){try{b.result=b.me.getResp(f,false,true);window.location=document.URL}catch(d){alert(d)}}})})}).insert({bottom:new Element("span",{"class":"button"}).update("Cancel").observe("click",function(){b.aliasObj=$(this).up(".pmc_row").retrieve("data");$(this).up(".pmc_row").replace(b.me._getAliasRow(b.aliasObj))})})},_getAliasRow:function(b){var a={};a.me=this;a.id=b.id;a.alias=b.alias;if(b&&a.alias!==""&&a.alias!==null&&a.alias!==undefined){return new Element("div",{"class":"pmc_row"}).store("data",b).insert({bottom:new Element("span",{"class":"single_alias"}).update(a.alias)}).insert({bottom:new Element("span",{"class":"single_alias_option"}).insert({bottom:new Element("span",{"class":"button"}).update("Edit").observe("click",function(){a.me._generateEditOptions(this)})}).insert({bottom:new Element("span",{"class":"button"}).update("Delete").observe("click",function(){a.confirmation=confirm("Are you sure you want to delete this alias ?");if(a.confirmation===false){return}a.parentRow=$(this).up(".pmc_row");a.parentSpan=$(this).up(".company_alias");a.originalData=a.parentRow.retrieve("data");a.me.postAjax(a.me.getCallbackId("deleteAliasForPriceMatchCompany"),{data:a.originalData},{onLoading:function(c,d){},onComplete:function(c,f){try{a.result=a.me.getResp(f,false,true);a.parentRow.remove();if(a.parentSpan.getElementsBySelector(".pmc_row").size()===0){a.parentSpan.up(".row").remove()}}catch(d){alert(d)}}})})})})}},_showHideAddAliasButton:function(b){var a={};a.me=this;a.parentDiv=b;a.parentDiv.getElementsBySelector(".addNewAliasBtn").each(function(c){c.remove()});if(a.parentDiv.getElementsBySelector("[newAliasBox]").size()>0){a.parentDiv.insert({bottom:new Element("span",{"class":"button addNewAliasBtn"}).update("Add Alias(s)").observe("click",function(){a.newAliasValueArray=[];a.pDiv=$(this).up("[pmc_company_name_container]");a.pDiv.getElementsBySelector(".msgDiv").each(function(c){c.remove()});a.addNewAlias=false;a.companyNameElement=a.pDiv.getElementsBySelector(".companyNameSpan")[0];if(!a.companyNameElement.hasAttribute("brand_new_company_name")){a.companyName=a.companyNameElement.innerHTML}else{a.addNewAlias=true;a.companyName=$F(a.companyNameElement).strip()}if(a.companyName===""||a.companyName===null||a.companyName===undefined){a.companyNameElement.insert({before:new Element("div",{"class":"msgDiv errorMsgDiv"}).update(new Element("div",{"class":"msg"}).update("Pls Enter Company Name"))});return}a.pDiv.getElementsBySelector("[newAliasBox]").each(function(c){if((a.newAliasValue=$F(c).strip())!==""&&a.newAliasValue!==null&&a.newAliasValue!==undefined){a.newAliasValueArray.push(a.newAliasValue)}});if(a.newAliasValueArray.size()===0){if(a.addNewAlias===false){a.allCompanyData=a.pDiv.up(".row").retrieve("allCompanyAliasData");a.pDiv.replace(a.me._displayCompanyNamePanelForAddEdit(a.allCompanyData,a.addNewAlias));alert("No New Aliase(s) added!");return}else{alert("Atleast One Alias needs to be added to Add a Brand New Company!!!");return}}else{a.me.postAjax(a.me.getCallbackId("addAliasForPriceMatchCompany"),{aliasArray:a.newAliasValueArray,companyName:a.companyName},{onLoading:function(c,d){},onComplete:function(c,f){try{a.result=a.me.getResp(f,false,true);window.location=document.URL}catch(d){alert(d)}}})}})})}return a.me},_addNewAliasBox:function(b){var a={};a.me=this;a.parentDiv=$(b).up("[pmc_company_name_container]");a.parentDiv.insert({bottom:new Element("div",{"class":"new_single_alias_box"}).insert({bottom:new Element("span",{}).insert({bottom:new Element("input",{type:"text",newAliasBox:"newAliasBox"})})}).insert({bottom:new Element("span",{"class":"button",title:"Remove This Alias"}).update("-").observe("click",function(){$(this).up(".new_single_alias_box").remove();a.me._showHideAddAliasButton(a.parentDiv)})})}).insert({bottom:new Element("div",{"class":"button"}).update("+").observe("click",function(){a.me._addNewAliasBox(this)})});a.me._showHideAddAliasButton(a.parentDiv);$(b).remove()},_displayCompanyNamePanelForAddEdit:function(b,c){var a={};a.me=this;a.add=(c===true)?true:false;a.item=b;a.headerDiv="";if(a.add===false){a.companyNameContainer=new Element("span",{"class":"companyNameSpan"}).update(a.item.companyName)}else{a.companyNameContainer=a.me._getFieldDiv("New Company Name:",new Element("input",{type:"text","class":"companyNameSpan",brand_new_company_name:"brand_new_company_name"}))}a.companyNameDiv=new Element("div",{"class":"companyNameDiv",pmc_company_name_container:"pmc_company_name_container"}).insert({bottom:new Element("div",{}).insert({bottom:a.companyNameContainer})}).insert({bottom:new Element("div",{"class":"button",title:"Add New Alias"}).update("+").observe("click",function(){a.me._addNewAliasBox(this)})});return a.companyNameDiv},_generateSingleRowForPriceMatchCompany:function(b){var a={};a.me=this;a.item=b;a.rowDiv=new Element("div",{"class":"row"});a.aliasSpan=new Element("span",{"class":"cell company_alias"});a.companyNameDiv=a.me._displayCompanyNamePanelForAddEdit(a.item,false);a.item.companyAliases.each(function(c){a.aliasSpan.insert({bottom:a.me._getAliasRow(c)})});a.rowDiv.store("allCompanyAliasData",b).insert({bottom:new Element("span",{"class":"cell company_name"}).update(a.companyNameDiv)}).insert({bottom:a.aliasSpan});return a.rowDiv},displayAllPriceMatchCompany:function(){var a={};a.me=this;a.me.displayAddCompanyPanel();a.me.postAjax(a.me.getCallbackId("getPriceMatchCompany"),{searchCriteria:a.me._searchCriteria,pagination:a.me._pageInfo},{onLoading:function(b,c){},onComplete:function(b,d){try{a.result=a.me.getResp(d,false,true);a.result.items.each(function(e){a.row=a.me._generateSingleRowForPriceMatchCompany(e);$(a.me._resultDivId).insert({bottom:a.row})})}catch(c){alert(c)}}});return a.me},displayAddCompanyPanel:function(){var a={};a.me=this;$(a.me._addCompanyDivId).update("");$(a.me._addCompanyDivId).insert({bottom:new Element("span",{"class":"add_new_company"}).insert({bottom:new Element("span",{"class":"button"}).update("Add New Company").observe("click",function(){a.newDiv=a.me._displayCompanyNamePanelForAddEdit({},true);a.parentSpan=$(this).up(".add_new_company");a.parentDiv=$(this).up(".add_new_company_div");a.parentSpan.update(a.newDiv);a.parentDiv.insert({bottom:new Element("span",{"class":"button"}).update("Cancel").observe("click",function(){a.me.displayAddCompanyPanel()})})})})})}});