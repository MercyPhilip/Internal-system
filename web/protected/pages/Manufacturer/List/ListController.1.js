var PageJs=new Class.create();PageJs.prototype=Object.extend(new BPCPageJs(),{resultDivId:"",searchDivId:"",totalNoOfItemsId:"",_pagination:{pageNo:1,pageSize:30},_searchCriteria:{},_infoTypes:{},orderStatuses:[],setHTMLIds:function(c,a,b){this.resultDivId=c;this.searchDivId=a;this.totalNoOfItemsId=b;return this},getSearchCriteria:function(){var a={};a.me=this;if(a.me._searchCriteria===null){a.me._searchCriteria={}}a.nothingTosearch=true;$(a.me.searchDivId).getElementsBySelector("[search_field]").each(function(b){a.me._searchCriteria[b.readAttribute("search_field")]=$F(b);if(($F(b) instanceof Array&&$F(b).size()>0)||(typeof $F(b)==="string"&&!$F(b).blank())){a.nothingTosearch=false}});if(a.nothingTosearch===true){a.me._searchCriteria=null}return this},getResults:function(c,a){var b={};b.me=this;b.reset=(c||false);b.resultDiv=$(b.me.resultDivId);if(b.reset===true){b.me._pagination.pageNo=1}b.me._pagination.pageSize=(a||b.me._pagination.pageSize);b.me.postAjax(b.me.getCallbackId("getItems"),{pagination:b.me._pagination,searchCriteria:b.me._searchCriteria},{onLoading:function(){jQuery("#"+b.me.searchDivId+" #searchBtn").button("loading")},onSuccess:function(d,g){try{b.result=b.me.getResp(g,false,true);if(!b.result){return}$(b.me.totalNoOfItemsId).update(b.result.pageStats.totalRows);if(b.reset===true){b.titleRow={description:"Description",name:"Name"};b.resultDiv.update(b.me._getResultRow(b.titleRow,true).wrap(new Element("thead")))}b.resultDiv.getElementsBySelector(".paginWrapper").each(function(e){e.remove()});b.tbody=$(b.resultDiv).down("tbody");if(!b.tbody){$(b.resultDiv).insert({bottom:b.tbody=new Element("tbody")})}b.result.items.each(function(e){b.tbody.insert({bottom:b.me._getResultRow(e)})});if(b.result.pageStats.pageNumber<b.result.pageStats.totalPages){b.resultDiv.insert({bottom:b.me._getNextPageBtn().addClassName("paginWrapper")})}}catch(f){alert(f);b.resultDiv.insert({bottom:b.me.getAlertBox("Error",f).addClassName("alert-danger")})}},onComplete:function(){jQuery("#"+b.me.searchDivId+" #searchBtn").button("reset")}})},_getNextPageBtn:function(){var a={};a.me=this;return new Element("tfoot").insert({bottom:new Element("tr").insert({bottom:new Element("td",{colspan:"5","class":"text-center"}).insert({bottom:new Element("span",{"class":"btn btn-primary","data-loading-text":"Fetching more results ..."}).update("Show More").observe("click",function(){a.me._pagination.pageNo=a.me._pagination.pageNo*1+1;jQuery(this).button("loading");a.me.getResults()})})})})},_saveItem:function(c,d,b){var a={};a.me=this;a.data=a.me._collectFormData(d,b);if(a.data===null){return}a.me.postAjax(a.me.getCallbackId("saveItem"),{item:a.data},{onLoading:function(){d.hide()},onSuccess:function(f,h){try{a.result=a.me.getResp(h,false,true);if(!a.result||!a.result.item){return}$(a.me.resultDivId).down("tbody").insert({top:a.me._getResultRow(a.result.item)});d.remove()}catch(g){alert(g);d.show()}}});return a.me},_getEditPanel:function(b){var a={};a.me=this;a.newDiv=new Element("tr",{"class":"save-item-panel info"}).store("data",b).insert({bottom:new Element("td",{"class":"form-group"}).insert({bottom:new Element("input",{required:true,"class":"form-control",placeholder:"The name of the Manufacturer","save-item-panel":"name",value:b.name?b.name:""})})}).insert({bottom:new Element("td",{"class":"form-group"}).insert({bottom:new Element("input",{"class":"form-control",placeholder:"Optional - The description of the Manufacturer","save-item-panel":"description",value:b.description?b.description:""})})}).insert({bottom:new Element("td",{"class":"text-right"}).insert({bottom:new Element("span",{"class":"btn-group btn-group-sm"}).insert({bottom:new Element("span",{"class":"btn btn-success",title:"Save"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-ok"})}).observe("click",function(){a.btn=this;a.me._saveItem(a.btn,$(a.btn).up(".save-item-panel"),"save-item-panel")})}).insert({bottom:new Element("span",{"class":"btn btn-danger",title:"Delete"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-remove"})}).observe("click",function(){if(b.id){$(this).up(".save-item-panel").replace(a.me._getResultRow(b))}else{$(this).up(".save-item-panel").remove()}})})})});return a.newDiv},_deleteItem:function(b){var a={};a.me=this;a.me.postAjax(a.me.getCallbackId("deleteItems"),{ids:[b.id]},{onSuccess:function(c,f){try{a.result=a.me.getResp(f,false,true);if(!a.result){return}}catch(d){alert(d)}}});return a.me},_getResultRow:function(c,a){var b={};b.me=this;b.tag=(b.isTitle===true?"th":"td");b.isTitle=(a||false);b.row=new Element("tr",{"class":(b.isTitle===true?"":"item_row btn-hide-row"),item_id:c.id}).store("data",c).insert({bottom:new Element(b.tag,{"class":"name col-xs-2"}).update(c.name)}).insert({bottom:new Element(b.tag,{"class":"description"}).update(c.description)}).insert({bottom:new Element(b.tag,{"class":"text-right btns col-xs-2"}).update(b.isTitle===true?(new Element("span",{"class":"btn btn-primary btn-xs",title:"New"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-plus"})}).insert({bottom:" NEW"}).observe("click",function(){$(this).up("thead").insert({bottom:b.me._getEditPanel({})})})):(new Element("span",{"class":"btn-group btn-group-xs"}).insert({bottom:new Element("span",{"class":"btn btn-default",title:"Edit"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-pencil"})}).observe("click",function(){$(this).up(".item_row").replace(b.me._getEditPanel(c))})}).insert({bottom:new Element("span",{"class":"btn btn-danger",title:"Delete"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-trash"})}).observe("click",function(){if(!confirm("Are you sure you want to delete this item?")){return false}$(this).up(".item_row").remove();b.me._deleteItem(c)})})))});return b.row}});