var PageJs=new Class.create;PageJs.prototype=Object.extend(new BPCPageJs,{init:function(){var a={};return a.me=this,a.me._bindDatePicker(),jQuery.each(jQuery(".select2"),function(b,c){jQuery(c).select2({multiple:!0,ajax:{url:"/ajax/getAll",dataType:"json",delay:10,type:"POST",data:function(a,b){return"Product"===jQuery(c).attr("entityName")?{searchTxt:"sku like ? or name like ?",searchParams:["%"+a+"%","%"+a+"%"],entityName:jQuery(c).attr("entityName"),pageNo:b,userId:jQuery("#userId").attr("value")}:{searchTxt:"name like ?",searchParams:["%"+a+"%"],entityName:jQuery(c).attr("entityName"),pageNo:b}},results:function(b,c,d){return a.result=[],b.resultData&&b.resultData.items&&b.resultData.items.each(function(b){a.result.push({id:b.id,text:b.orderNo,data:b})}),{results:a.result,more:b.resultData&&b.resultData.pagination&&b.resultData.pagination.totalPages&&c<b.resultData.pagination.totalPages}},cache:!0},formatResult:function(a){return a?"Product"===jQuery(c).attr("entityName")?'<div class="row"><div class="col-xs-4">'+a.data.sku+'</div><div class="col-xs-8">'+a.data.name+"</div></div>":"ProductCategory"===jQuery(c).attr("entityName")?'<div class="row"><div class="col-xs-12">'+a.data.namePath+"</div></div>":'<div class="row"><div class="col-xs-12">'+a.data.name+"</div></div>":""},formatSelection:function(b){return b?(a.text=b.data.name,"Product"===jQuery(c).attr("entityName")?a.text=b.data.sku:"ProductCategory"===jQuery(c).attr("entityName")&&(a.text=b.data.namePath),a.newDiv=new Element("div").update(a.text),a.newDiv):""},escapeMarkup:function(a){return a},minimumInputLength:2})}),a.me},_bindDatePicker:function(){var a={};return a.me=this,dfromCtl=jQuery('[search_field="runRateDate_from"]'),dfromCtl=dfromCtl[0],a.me._signRandID(dfromCtl),dtoCtl=jQuery('[search_field="runRateDate_to"]'),dtoCtl=dtoCtl[0],a.me._signRandID(dtoCtl),jQuery("#"+dfromCtl.id).datetimepicker({format:"YYYY-MM-DD",useCurrent:!1}),jQuery("#"+dtoCtl.id).datetimepicker({format:"YYYY-MM-DD",useCurrent:!1}),jQuery("#"+dfromCtl.id).on("dp.change",function(a){a.date?jQuery("#"+dtoCtl.id).data("DateTimePicker").minDate(a.date):jQuery("#"+dtoCtl.id).data("DateTimePicker").minDate("0001-01-01")}),jQuery("#"+dtoCtl.id).on("dp.change",function(a){a.date?jQuery("#"+dfromCtl.id).data("DateTimePicker").maxDate(a.date):jQuery("#"+dfromCtl.id).data("DateTimePicker").maxDate("9999-01-01")}),a.me},genReport:function(a){var b={};return b.me=this,b.data={},$$("[search_field]").each(function(a){b.data[a.readAttribute("search_field")]=$F(a)}),b.me.postAjax(b.me.getCallbackId("genReportmBtn"),b.data,{onLoading:function(){jQuery(a).button("loading")},onSuccess:function(a,c){try{if(b.result=b.me.getResp(c,!1,!0),!b.result||!b.result.url)return;if(b.newWind=window.open(b.result.url),!b.newWind)throw'You browser is blocking the popup window, please click <a class="btn btn-xs btn-primary" href="'+b.result.url+'" target="__BLANK">here</a> to open it manually.'}catch(a){b.me.showModalBox("<b>Error:</b>",'<b class="text-danger">'+a+"</b>")}},onComplete:function(){jQuery(a).button("reset")}}),b.me}});