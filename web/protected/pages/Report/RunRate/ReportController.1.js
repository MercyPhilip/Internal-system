var PageJs=new Class.create;
PageJs.prototype=Object.extend(new BPCPageJs,{init:function(){var b,c,e;this._bindDatePicker();jQuery.each(jQuery(".select2"),function(f,d){jQuery(d).select2({multiple:!0,ajax:{url:"/ajax/getAll",dataType:"json",delay:10,type:"POST",data:function(a,b){return"Product"===jQuery(d).attr("entityName")?{searchTxt:"sku like ? or name like ?",searchParams:["%"+a+"%","%"+a+"%"],entityName:jQuery(d).attr("entityName"),pageNo:b}:{searchTxt:"name like ?",searchParams:["%"+a+"%"],entityName:jQuery(d).attr("entityName"),
pageNo:b}},results:function(a,c,d){b=[];a.resultData&&a.resultData.items&&a.resultData.items.each(function(a){b.push({id:a.id,text:a.orderNo,data:a})});return{results:b,more:a.resultData&&a.resultData.pagination&&a.resultData.pagination.totalPages&&c<a.resultData.pagination.totalPages}},cache:!0},formatResult:function(a){return a?"Product"===jQuery(d).attr("entityName")?'<div class="row"><div class="col-xs-4">'+a.data.sku+'</div><div class="col-xs-8">'+a.data.name+"</div></div>":"ProductCategory"===
jQuery(d).attr("entityName")?'<div class="row"><div class="col-xs-12">'+a.data.namePath+"</div></div>":'<div class="row"><div class="col-xs-12">'+a.data.name+"</div></div>":""},formatSelection:function(a){if(!a)return"";c=a.data.name;"Product"===jQuery(d).attr("entityName")?c=a.data.sku:"ProductCategory"===jQuery(d).attr("entityName")&&(c=a.data.namePath);return e=(new Element("div")).update(c)},escapeMarkup:function(a){return a},minimumInputLength:3})});return this},_bindDatePicker:function(){dfromCtl=
jQuery('[search_field="runRateDate_from"]');dfromCtl=dfromCtl[0];this._signRandID(dfromCtl);dtoCtl=jQuery('[search_field="runRateDate_to"]');dtoCtl=dtoCtl[0];this._signRandID(dtoCtl);jQuery("#"+dfromCtl.id).datetimepicker({format:"YYYY-MM-DD",useCurrent:!1});jQuery("#"+dtoCtl.id).datetimepicker({format:"YYYY-MM-DD",useCurrent:!1});jQuery("#"+dfromCtl.id).on("dp.change",function(b){b.date?jQuery("#"+dtoCtl.id).data("DateTimePicker").minDate(b.date):jQuery("#"+dtoCtl.id).data("DateTimePicker").minDate("0001-01-01")});
jQuery("#"+dtoCtl.id).on("dp.change",function(b){b.date?jQuery("#"+dfromCtl.id).data("DateTimePicker").maxDate(b.date):jQuery("#"+dfromCtl.id).data("DateTimePicker").minDate("0001-01-01")});return this},genReport:function(b){var c,e,f,d;c=this;e={};$$("[search_field]").each(function(a){e[a.readAttribute("search_field")]=$F(a)});c.postAjax(c.getCallbackId("genReportmBtn"),e,{onLoading:function(){jQuery(b).button("loading")},onSuccess:function(a,b){try{if((f=c.getResp(b,!1,!0))&&f.url&&(d=window.open(f.url),
!d))throw'You browser is blocking the popup window, please click <a class="btn btn-xs btn-primary" href="'+f.url+'" target="__BLANK">here</a> to open it manually.';}catch(e){c.showModalBox("<b>Error:</b>",'<b class="text-danger">'+e+"</b>")}},onComplete:function(){jQuery(b).button("reset")}});return c}});