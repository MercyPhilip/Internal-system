var PageJs=new Class.create;
PageJs.prototype=Object.extend(new BPCPageJs,{init:function(){var c,b,e;this._bindDatePicker();jQuery.each(jQuery(".select2"),function(f,d){jQuery(d).select2({multiple:!0,ajax:{url:"/ajax/getAll",dataType:"json",delay:10,type:"POST",data:function(a,b){return"Product"===jQuery(d).attr("entityName")?{searchTxt:"sku like ? or name like ?",searchParams:["%"+a+"%","%"+a+"%"],entityName:jQuery(d).attr("entityName"),pageNo:b}:{searchTxt:"name like ?",searchParams:["%"+a+"%"],entityName:jQuery(d).attr("entityName"),
pageNo:b}},results:function(a,b,d){c=[];a.resultData&&a.resultData.items&&a.resultData.items.each(function(a){c.push({id:a.id,text:a.orderNo,data:a})});return{results:c,more:a.resultData&&a.resultData.pagination&&a.resultData.pagination.totalPages&&b<a.resultData.pagination.totalPages}},cache:!0},formatResult:function(a){return a?"Product"===jQuery(d).attr("entityName")?'<div class="row"><div class="col-xs-4">'+a.data.sku+'</div><div class="col-xs-8">'+a.data.name+"</div></div>":"ProductCategory"===
jQuery(d).attr("entityName")?'<div class="row"><div class="col-xs-12">'+a.data.namePath+"</div></div>":'<div class="row"><div class="col-xs-12">'+a.data.name+"</div></div>":""},formatSelection:function(a){if(!a)return"";b=a.data.name;"Product"===jQuery(d).attr("entityName")?b=a.data.sku:"ProductCategory"===jQuery(d).attr("entityName")&&(b=a.data.namePath);return e=(new Element("div")).update(b)},escapeMarkup:function(a){return a},minimumInputLength:3})});return this},_bindDatePicker:function(){dfromCtl=
jQuery('[search_field="runRateDate_from"]');dfromCtl=dfromCtl[0];this._signRandID(dfromCtl);dtoCtl=jQuery('[search_field="runRateDate_to"]');dtoCtl=dtoCtl[0];this._signRandID(dtoCtl);jQuery("#"+dfromCtl.id).datetimepicker({format:"YYYY-MM-DD",useCurrent:!1});jQuery("#"+dtoCtl.id).datetimepicker({format:"YYYY-MM-DD",useCurrent:!1});jQuery("#"+dfromCtl.id).on("dp.change",function(c){jQuery("#"+dtoCtl.id).data("DateTimePicker").minDate(c.date)});jQuery("#"+dtoCtl.id).on("dp.change",function(c){jQuery("#"+
dfromCtl.id).data("DateTimePicker").maxDate(c.date)});return this},genReport:function(c){var b,e,f,d;b=this;e={};$$("[search_field]").each(function(a){e[a.readAttribute("search_field")]=$F(a)});b.postAjax(b.getCallbackId("genReportmBtn"),e,{onLoading:function(){jQuery(c).button("loading")},onSuccess:function(a,c){try{if((f=b.getResp(c,!1,!0))&&f.url&&(d=window.open(f.url),!d))throw'You browser is blocking the popup window, please click <a class="btn btn-xs btn-primary" href="'+f.url+'" target="__BLANK">here</a> to open it manually.';
}catch(e){b.showModalBox("<b>Error:</b>",'<b class="text-danger">'+e+"</b>")}},onComplete:function(){jQuery(c).button("reset")}});return b}});