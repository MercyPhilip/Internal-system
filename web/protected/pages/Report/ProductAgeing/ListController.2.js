var PageJs=new Class.create;
PageJs.prototype=Object.extend(new CRUDPageJs,{_getTitleRowData:function(){return{lastPurchaseTime:"Last Purchase Time",comments:"Comments",active:"Active?",product:{sku:"SKU",name:"Name"},receivingItem:{title:"ReceivingItem",qty:"Qty"},purchaseOrderItem:{title:"Purchase Order Item",qty:"Qty"},orderItem:{title:"Order Item",unitCost:"Unit Cost"},creditNoteItem:{title:"Credit Note Item",qty:"Qty"},productQtyLog:{title:"Product Qty Log",type:"Type",created:"Created"}}},_loadDataPicker:function(){$$(".datepicker").each(function(a){new Prado.WebUI.TDatePicker({ID:a,InputMode:"TextBox",
Format:"yyyy-MM-dd 00:00:00",FirstDayOfWeek:1,CalendarStyle:"default",FromYear:2009,UpToYear:2024,PositionMode:"Bottom",ClassName:"datepicker-layer-fixer"})});return this},_bindSearchKey:function(){var a,d,b;a=this;$$("#searchBtn").first().observe("click",function(b){$$("#showSearch").first().checked?a.getSearchCriteria().getResults(!0,a._pagination.pageSize):$$("#showSearch").first().click()});$("searchDiv").getElementsBySelector("[search_field]").each(function(b){b.observe("keydown",function(b){a.keydown(b,
function(){$(a.searchDivId).down("#searchBtn").click()})})});d=(new Element("input",{"class":"select2 form-control","data-placeholder":"search for a Products",search_field:"pro.id"})).insert({bottom:(new Element("option")).update("")});$("searchDiv").down('[search_field="pro.id"]').replace(d);jQuery('.select2[search_field="pro.id"]').select2({allowClear:!0,hidden:!0,multiple:!1,ajax:{url:"/ajax/getProducts",dataType:"json",delay:10,data:function(b){return{searchTxt:b,pageNo:1,pageSize:10}},results:function(a){b=
[];a.resultData.items.each(function(a){b.push({id:a.id,text:a.name,data:a})});return{results:b}},cache:!0},formatResult:function(a){return a?"<div value="+a.data.id+">"+a.data.name+"</div >":""},escapeMarkup:function(a){return a},minimumInputLength:3});return this},_highlightSelectedRow:function(a){a=a.down(".glyphicon-plus")?"":$(a).up("[item_id]").retrieve("data");jQuery(".item_row.success").removeClass("success");jQuery("[item_id="+a.id+"]").addClass("success")},_getLinkAddress:function(a,d,b){var c;
b=b||[];c="";0<b.length&&(c="?",b.each(function(a){c=c+$H(a).keys()[0]+"="+$H(a).values()[0]+"&"}),c=c.substring(0,c.length-1));return"/"+a+(!0===jQuery.isNumeric(d)?"/"+d:"")+".html"+c},_getLink:function(a,d,b,c,e){c=c||null;return(new Element("a",{target:"_blank",href:null===c?this._getLinkAddress(a,d,e):c})).update(b)},_getResultRow:function(a,d){var b={me:this};b.tag=!0===b.isTitle?"th":"td";b.isTitle=d||!1;b.row=(new Element("tr",{"class":(!0===b.isTitle?"item_top_row":"btn-hide-row item_row")+
(0==a.active?" danger":""),item_id:!0===b.isTitle?"":a.id})).store("data",a).insert({bottom:(new Element(b.tag,{"class":"col-xs-1"})).update(!0===b.isTitle?"Product Name":b.me._getLink("product",a.product.id,a.product.name))}).insert({bottom:(new Element(b.tag,{"class":"col-xs-1"})).update(a.product.sku)}).insert({bottom:(new Element(b.tag,{"class":"col-xs-1"})).update(!0===b.isTitle?"Last Purchase Date (UTC)":a.productQtyLog.created)}).insert({bottom:(new Element(b.tag,{"class":"col-xs-1"})).update(!0===
b.isTitle?a.receivingItem.title:a.receivingItem.id?b.me._getLink("productqtylog",null,b.me._getTitleRowData().receivingItem.title,null,[{productid:a.product.id}]):"N/A")});return b.row},_getNextPageBtn:function(){var a;a=this;return(new Element("tfoot")).insert({bottom:(new Element("tr")).insert({bottom:(new Element("td",{colspan:"8","class":"text-center"})).insert({bottom:(new Element("span",{"class":"btn btn-primary","data-loading-text":"Fetching more results ..."})).update("Show More").observe("click",
function(){a._pagination.pageNo=1*a._pagination.pageNo+1;jQuery(this).button("loading");a.getResults()})})})})}});