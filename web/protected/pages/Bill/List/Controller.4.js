var PageJs=new Class.create;PageJs.prototype=Object.extend(new CRUDPageJs,{_getTitleRowData:function(){return{}},_openDetailsPage:function(e){var t={};return t.me=this,jQuery.fancybox({width:"95%",height:"95%",autoScale:!1,autoDimensions:!1,fitToView:!1,autoSize:!1,type:"iframe",href:"/bills/"+e.supplier.id+".html?blanklayout=1&invoiceNo="+e.invoiceNo}),t.me},_getResultRow:function(e,t){var a={};return a.me=this,a.tag=a.isTitle===!0?"th":"td",a.isTitle=t||!1,a.row=new Element("tr",{"class":a.isTitle===!0?"":"item_row"}).store("data",e).insert({bottom:new Element(a.tag,{"class":"col-sm-1"}).update(a.isTitle===!0?"Inv. No.":new Element("a",{href:"javascript: void(0);"}).update(e.invoiceNo).observe("click",function(){a.me._openDetailsPage(e)}))}).insert({bottom:new Element(a.tag,{"class":"col-sm-1"}).update(a.isTitle===!0?"Created":moment(a.me.loadUTCTime(e.created)).format("ll"))}).insert({bottom:new Element(a.tag,{"class":"col-sm-2"}).update(a.isTitle===!0?"Supplier":e.supplier.name)}).insert({bottom:new Element(a.tag,{"class":"col-sm-2"}).update(a.isTitle===!0?"Total Qty":e.totalQty)}).insert({bottom:new Element(a.tag,{"class":"col-sm-2"}).update(a.isTitle===!0?"Total Price(ex GST)":a.me.getCurrency(e.totalPrice))}).insert({bottom:new Element(a.tag,{"class":"col-sm-2"}).update(a.isTitle===!0?"Total Price(inc GST)":a.me.getCurrency(1.1*e.totalPrice))}).insert({bottom:new Element(a.tag,{"class":"col-sm-4"}).update(a.isTitle===!0?"Purchase Orders":a.purchaseOrderList=new Element("ul",{"class":"list-inline"}))}),e.purchaseOrders&&a.purchaseOrderList&&e.purchaseOrders.each(function(e){a.purchaseOrderList.insert({bottom:new Element("li").insert({bottom:new Element("a",{target:"_BLANK",href:"/purchase/"+e.id+".html"}).update(e.purchaseOrderNo)})})}),a.row},_initSelect2_Supplier:function(){var e={};return e.me=this,jQuery('.select2[search_field="supplierIds"]').select2({allowClear:!0,hidden:!0,multiple:!0,ajax:{url:"/ajax/getSuppliers",dataType:"json",delay:10,data:function(e){return{searchTxt:e}},results:function(t){return e.result=[],t.resultData.items.each(function(t){e.result.push({id:t.id,text:t.name,data:t})}),{results:e.result}},cache:!0},formatResult:function(e){return e?"<div value="+e.data.id+">"+e.data.name+"</div >":""},escapeMarkup:function(e){return e},minimumInputLength:1}),e.me},_initSelect2_po:function(){var e={};return e.me=this,jQuery('.select2[search_field="purchaseOrderIds"]').select2({allowClear:!0,hidden:!0,multiple:!0,ajax:{url:"/ajax/getAll",dataType:"json",delay:10,data:function(e){return{entityName:"PurchaseOrder",searchTxt:"po.purchaseOrderNo like :poNo",searchParams:{poNo:"%"+e+"%"}}},results:function(t){return e.result=[],t.resultData.items.each(function(t){e.result.push({id:t.id,text:t.purchaseOrderNo,data:t})}),{results:e.result}},cache:!0},formatResult:function(e){return e?"<div value="+e.data.id+">"+e.data.purchaseOrderNo+" ("+e.data.supplier.name+")</div >":""},escapeMarkup:function(e){return e},minimumInputLength:1}),e.me},init:function(){var e={};return e.me=this,e.me._initSelect2_Supplier()._initSelect2_po(),$$("#searchBtn").first().observe("click",function(t){$$("#showSearch").first().checked?e.me.getSearchCriteria().getResults(!0,e.me._pagination.pageSize):$$("#showSearch").first().click()}),e.me}});