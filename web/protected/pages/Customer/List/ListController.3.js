var PageJs=new Class.create();PageJs.prototype=Object.extend(new CRUDPageJs(),{_getTitleRowData:function(){return{email:"Email",name:"Name",contactNo:"Contact Num",description:"Description",addresses:"Addresses",address:{billing:{full:"Billing Address"},shipping:{full:"Shipping Address"}},mageId:"Mage Id",active:"Active?"}},_bindSearchKey:function(){var a={};a.me=this;$$("#searchBtn").first().observe("click",function(b){if(!$$("#showSearch").first().checked){$$("#showSearch").first().click()}else{a.me.getSearchCriteria().getResults(true,a.me._pagination.pageSize)}});$("searchDiv").getElementsBySelector("[search_field]").each(function(b){b.observe("keydown",function(c){a.me.keydown(c,function(){$(a.me.searchDivId).down("#searchBtn").click()})})});return this},_openEditPage:function(b){var a={};a.me=this;jQuery.fancybox({width:"95%",height:"95%",autoScale:false,autoDimensions:false,fitToView:false,autoSize:false,type:"iframe",frameborder:"0",border:"0",seamless:"seamless",href:"/customer/"+(b&&b.id?b.id:"new")+".html"});return a.me},_highlightSelectedRow:function(b){var a={};a.me=this;a.item=b.down(".glyphicon-plus")?"":$(b).up("[item_id]").retrieve("data");jQuery(".item_row.success").removeClass("success");a.selectedRow=jQuery("[item_id="+a.item.id+"]").addClass("success")},_displaySelectedAddress:function(b){var a={};a.me=this;a.item=$(b).up("[item_id]").retrieve("data");a.type=$(b).down("span").classList.contains("address-shipping");jQuery(".popover-loaded").popover("hide");jQuery(".item_row.success").removeClass("success");a.selectedRow=jQuery("[item_id="+a.item.id+"]").addClass("success");a.me._signRandID(b);if(!jQuery("#"+b.id).hasClass("popover-loaded")){jQuery("#"+b.id).popover({title:'<div class="row"><div class="col-xs-10">Details for: '+a.item.name+'</div><div class="col-xs-2" style="cursor: pointer" href="javascript:void(0);" onclick="jQuery(\'#'+b.id+"').popover('hide');\"><span class=\"pull-right glyphicon glyphicon-remove\" ></span></div></div>",html:true,placement:function(){return a.type?"left":"right"},container:"body",trigger:"manual",viewport:{selector:".list-panel",padding:0},content:function(){return a.type?"<p>"+a.item.address.shipping.full+"</p>":"<p>"+a.item.address.billing.full+"</p>"},template:'<div class="popover" role="tooltip" style="max-width: none; z-index: 0;"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}).addClass("popover-loaded")}jQuery("#"+b.id).popover("toggle");return a.me},_getResultRow:function(c,a){var b={};b.me=this;b.tag=(b.isTitle===true?"th":"td");b.isTitle=(a||false);b.row=new Element("tr",{"class":(b.isTitle===true?"item_top_row":"btn-hide-row item_row")+(c.active==0?" danger":""),item_id:(b.isTitle===true?"":c.id)}).store("data",c).insert({bottom:new Element(b.tag,{"class":"name col-xs-1"}).update(c.name).observe("click",function(){b.me._highlightSelectedRow(this);$$(".popover-loaded").each(function(d){jQuery(d).popover("hide")})}).observe("dblclick",function(){$$(".popover-loaded").each(function(d){jQuery(d).popover("hide")});b.me._openEditPage(c)})}).insert({bottom:new Element(b.tag,{"class":"email col-xs-1",style:"text-decoration: underline;"}).update(c.email).observe("click",function(){b.me._highlightSelectedRow(this);$$(".popover-loaded").each(function(d){jQuery(d).popover("hide")})}).observe("dblclick",function(){$$(".popover-loaded").each(function(d){jQuery(d).popover("hide")});b.newWindow=window.open("mailto:"+c.email,"location=no, menubar=no, status=no, titlebar=no, fullscreen=yes, toolbar=no");b.newWindow.close()})}).insert({bottom:new Element(b.tag,{"class":"contact col-xs-1 truncate"}).update(c.contactNo)}).insert({bottom:new Element(b.tag,{"class":"description col-xs-1"}).update(c.description)}).insert({bottom:new Element(b.tag,{"class":"address col-xs-1"}).insert({bottom:b.isTitle===true?c.addresses:new Element("span",{style:"display: inline-block"}).insert({bottom:new Element("a",{"class":"visible-xs visible-md visible-sm visible-lg",href:"javascript: void(0);"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-plane address-shipping",style:"font-size: 1.3em"})}).observe("click",function(){b.me._displaySelectedAddress(this)})})}).insert({bottom:b.isTitle===true?"":new Element("span",{style:"display: inline-block"}).insert({bottom:new Element("a",{"class":"visible-xs visible-md visible-sm visible-lg",href:"javascript: void(0);"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-usd address-billing",style:"font-size: 1.3em; padding-left:10%;"})}).observe("click",function(){b.me._displaySelectedAddress(this)})})})}).insert({bottom:new Element(b.tag,{"class":"mageId col-xs-1"}).update(c.mageId)}).insert({bottom:new Element(b.tag,{"class":"cust_active col-xs-1"}).insert({bottom:(b.isTitle===true?c.active:new Element("input",{type:"checkbox",disabled:true,checked:c.active}))})}).insert({bottom:new Element(b.tag,{"class":"text-right col-xs-1"}).update(b.isTitle===true?(new Element("span",{"class":"btn btn-primary btn-xs",title:"New"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-plus"})}).insert({bottom:" NEW"}).observe("click",function(){$(this).up("thead").insert({bottom:b.me._openEditPage()})})):(new Element("span",{"class":"btn-group btn-group-xs"}).insert({bottom:new Element("span",{"class":"btn btn-default",title:"Edit"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-pencil"})}).observe("click",function(){$$(".popover-loaded").each(function(d){jQuery(d).popover("hide")});b.me._openEditPage(c)})}).insert({bottom:new Element("span",{"class":"btn btn-danger",title:"Delete"}).insert({bottom:new Element("span",{"class":"glyphicon glyphicon-trash"})}).observe("click",function(){if(!confirm("Are you sure you want to deactivate this item?")){return false}if(c.active){b.me._deactivateItem(this)}$$(".popover-loaded").each(function(d){jQuery(d).popover("hide")})})}))).observe("click",function(){b.me._highlightSelectedRow(this);$$(".popover-loaded").each(function(d){jQuery(d).popover("hide")})})});return b.row},_getNextPageBtn:function(){var a={};a.me=this;return new Element("tfoot").insert({bottom:new Element("tr").insert({bottom:new Element("td",{colspan:"8","class":"text-center"}).insert({bottom:new Element("span",{"class":"btn btn-primary","data-loading-text":"Fetching more results ..."}).update("Show More").observe("click",function(){a.me._pagination.pageNo=a.me._pagination.pageNo*1+1;jQuery(this).button("loading");a.me.getResults()})})})})},_deactivateItem:function(b){var a={};a.me=this;a.row=$(b).up("[item_id]");a.item=a.row.retrieve("data");a.me.postAjax(a.me.getCallbackId("deactivateItems"),{item_id:a.item.id},{onLoading:function(){if(a.row){a.row.toggleClassName("danger");a.row.hide()}},onSuccess:function(c,f){try{a.row.toggleClassName("danger");a.result=a.me.getResp(f,false,true);if(!a.result.item){throw"errror"}$$('[item_id="'+a.result.item.id+'"]').first().replace(a.me._getResultRow(a.result.item,false));a.me._highlightSelectedRow($$('[item_id="'+a.result.item.id+'"]').first().down(".glyphicon.glyphicon-trash"))}catch(d){a.me.showModalBox('<span class="text-danger">ERROR</span>',d,true)}}})}});